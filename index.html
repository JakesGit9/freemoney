<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Grampa's Life Support Simulator 2000!</title>
<style>
body {
  margin: 0;
  height: 100vh;
  overflow: hidden;
  background: radial-gradient(circle at top, #cfd8dc, #90a4ae);
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  font-family: 'Comic Sans MS', Arial, sans-serif;
  user-select: none;
}

/* ads */
.ad {
  position: absolute;
  cursor: grab;
  z-index: 10;
  opacity: 0.97;
  border: 3px solid #fff;
  border-radius: 10px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.3);
  animation: floatIn 0.4s ease;
  background-color: white;
  transition: transform 0.15s;
  touch-action: none;
}
.ad:hover { transform: scale(1.05); }
.ad img {
  display: block;
  max-width: 160px;
  max-height: 160px;
  border-radius: 8px;
  user-select: none;
  pointer-events: none;
}
.ad .close-btn {
  position: absolute;
  top: 3px;
  right: 5px;
  background: rgba(0,0,0,0.6);
  color: white;
  font-weight: bold;
  font-family: sans-serif;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  text-align: center;
  line-height: 18px;
  font-size: 16px;
  cursor: pointer;
  z-index: 15;
  transition: background-color 0.2s, transform 0.15s;
}
.ad .close-btn:hover { background: red; transform: scale(1.2); }

@keyframes floatIn {
  0% { transform: scale(0.6) rotate(-5deg); opacity: 0; }
  100% { transform: scale(1) rotate(0); opacity: 1; }
}

/* buttons */
#startButton, #addTimeButton {
  padding: 28px 40px;
  background: linear-gradient(135deg, #007bff, #0056b3);
  color: white;
  border: none;
  font-size: 24px;
  cursor: pointer;
  border-radius: 14px;
  transition: all 0.3s;
  box-shadow: 0 6px 14px rgba(0,0,0,0.3);
}

#startButton:hover { background: linear-gradient(135deg, #0056b3, #004097); transform: scale(1.08); }

/* Kick His Life Support button */
#addTimeButton {
  display: none;
  margin-top: 10px;
  z-index: 0;
}

#addTimeButton:hover:not(.disabled) { transform: scale(1.08); }
#addTimeButton:active:not(.disabled) { transform: scale(0.95); }

#addTimeButton.disabled {
  background: gray !important;
  cursor: not-allowed;
  transform: scale(1) !important;
}
#addTimeButton.disabled:hover { transform: scale(1) !important; }

#startButton { margin-top: 20px; z-index: 50; }

#titleScreen {
  font-size: 48px;
  font-weight: 900;
  margin-bottom: 10px;
  text-align: center;
  text-shadow: 2px 2px 8px #00000055;
  color: #222;
}

#newUpdateBanner {
  background: linear-gradient(90deg, #ff4444, #ff7777);
  color: white;
  font-weight: bold;
  padding: 12px 24px;
  border-radius: 12px;
  margin-bottom: 15px;
  font-size: 22px;
  animation: pulse 1.2s infinite;
  z-index: 50;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}
@keyframes pulse {
  0% { transform: scale(1); opacity: 1 }
  50% { transform: scale(1.1); opacity: 0.85 }
  100% { transform: scale(1); opacity: 1 }
}

#instructions {
  font-size: 19px;
  margin-bottom: 20px;
  text-align: center;
  max-width: 500px;
  z-index: 50;
  color: #333;
}

/* HUD */
#lifeSupportImage {
  width: 220px;
  height: auto;
  margin-bottom: 15px;
  position: relative;
  z-index: 100;
  transition: transform 0.3s ease;
}
#lifeSupportImage:active { transform: rotate(-5deg) scale(0.97); }

#timerContainer {
  position: absolute;
  top: 60px;
  left: 50%;
  transform: translateX(-50%);
  width: 60%;
  background-color: #ddd;
  border-radius: 12px;
  overflow: hidden;
  display: none;
  z-index: 100;
  box-shadow: 0 5px 15px rgba(0,0,0,0.25);
}
#timerBar {
  height: 25px;
  width: 100%;
  background: linear-gradient(90deg, #28a745, #218838);
  transition: width 0.3s, background-color 0.3s;
}

#scoreCounter, #highScore {
  position: absolute;
  left: 20px;
  font-weight: bold;
  color: #222;
  text-shadow: 0 1px 2px rgba(255,255,255,0.4);
}
#scoreCounter { top: 15px; font-size: 24px; }
#highScore { top: 50px; font-size: 20px; }

/* game over */
#gameOverScreen {
  display: none;
  position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.85);
  color: white;
  font-size: 42px;
  font-weight: bold;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 200;
  opacity: 0;
  transition: opacity 0.8s;
  text-align: center;
}
#gameOverScreen.show { display: flex; opacity: 1; }
#finalScore { font-size: 28px; margin-top: 15px; }

#restartButton {
  margin-top: 25px;
  padding: 16px 30px;
  font-size: 22px;
  background: linear-gradient(90deg, #ff4444, #cc0000);
  border: none;
  border-radius: 10px;
  color: white;
  cursor: pointer;
  transition: all 0.3s;
  box-shadow: 0 6px 14px rgba(0,0,0,0.4);
}
#restartButton:hover { background: linear-gradient(90deg, #cc0000, #990000); transform: scale(1.05); }

.disabled {
  background: gray !important;
  cursor: not-allowed;
  transform: none !important;
}
</style>
</head>
<body>

<div id="newUpdateBanner">ðŸš¨ NEW UPDATE ðŸš¨ - Version beta alpha sigma prefix bugpatch 1.69 2000</div>
<div id="titleScreen">Grampa's Life Support Simulator 2000 Edition!</div>
<div id="instructions">
  Attempt to kill grandpa by pressing the blue button before the timer runs out!<br>
  But beware of the annoying ads that try to block you...
</div>

<img id="lifeSupportImage" src="image1.png" alt="Life Support Image">
<button id="addTimeButton">Kick His Life Support</button>
<button id="startButton">Start Game</button>

<div id="timerContainer"><div id="timerBar"></div></div>
<div id="scoreCounter">Score: 0</div>
<div id="highScore">High Score: 0</div>

<div id="gameOverScreen">
  <div id="gameOverText">ðŸ’€ Game Over! ðŸ’€</div>
  <div id="finalScore">Final Score: 0</div>
  <button id="restartButton">Restart</button>
</div>

<script>
// JS logic stays exactly the same
const adImages = ['ad1.jpg','ad2.jpg','ad3.jpg','ad4.jpg','ad5.jpg','ad6.jpg','ad7.jpg','ad8.jpg','ad9.jpg','ad10.jpg','ad11.jpg','ad12.jpg','ad13.jpg','ad14.jpg','ad15.jpg','ad16.jpg','ad17.jpg','ad18.jpg','ad19.jpg'];
const adLink = "https://lordmozart.github.io/scam/";

let adsSpawned = 0;
let adInterval = 950;
let timer = 10;
let score = 0;
let highScore = localStorage.getItem("highScore") || 0;
let gameInterval, spawnInterval, scoreInterval;
let canAddTime = true;
let gameRunning = false;
let mouseX = 0, mouseY = 0;

document.onmousemove = e => { mouseX = e.clientX; mouseY = e.clientY; };

const timerContainer = document.getElementById("timerContainer");
const timerBar = document.getElementById("timerBar");
const scoreCounter = document.getElementById("scoreCounter");
const highScoreDisplay = document.getElementById("highScore");
const startButton = document.getElementById("startButton");
const addTimeButton = document.getElementById("addTimeButton");
const titleScreen = document.getElementById("titleScreen");
const instructions = document.getElementById("instructions");
const lifeSupportImage = document.getElementById("lifeSupportImage");
const gameOverScreen = document.getElementById("gameOverScreen");
const restartButton = document.getElementById("restartButton");
const newUpdateBanner = document.getElementById("newUpdateBanner");
const finalScore = document.getElementById("finalScore");

highScoreDisplay.innerText = "High Score: " + highScore;

startButton.onclick = () => {
  startButton.style.display = "none";
  instructions.style.display = "none";
  titleScreen.style.display = "none";
  addTimeButton.style.display = "block";
  timerContainer.style.display = "block";
  newUpdateBanner.style.display = "none";
  scoreCounter.style.display = "block";
  highScoreDisplay.style.display = "block";
  timer = 10; score = 0;
  updateTimerBar(); updateScore();
  startTimer(); startScore();
  spawnInterval = setInterval(spawnAd, adInterval);
  gameRunning = true;
};

addTimeButton.onclick = () => {
  if (canAddTime) {
    timer = Math.min(timer + 2, 10);
    updateTimerBar();
    canAddTime = false;
    addTimeButton.classList.add("disabled");
    addTimeButton.disabled = true;
    const originalSrc = lifeSupportImage.src;
    lifeSupportImage.src = "image2.png";
    setTimeout(() => { lifeSupportImage.src = originalSrc; }, 750);
    setTimeout(() => {
      addTimeButton.classList.remove("disabled");
      addTimeButton.disabled = false;
      canAddTime = true;
    }, 750);
  }
};

function startTimer() {
  gameInterval = setInterval(() => {
    if (!document.hidden && gameRunning) {
      timer--; updateTimerBar();
      if (timer <= 0) endGame();
    }
  }, 1000);
}

function startScore() {
  scoreInterval = setInterval(() => {
    if (!document.hidden && gameRunning) {
      score++; updateScore();
    }
  }, 1000);
}

function updateTimerBar() {
  let cappedTime = Math.min(timer, 10);
  let percent = Math.max(0, (cappedTime / 10) * 100);
  timerBar.style.width = percent + "%";
  timerBar.style.background =
    percent > 50 ? "linear-gradient(90deg,#28a745,#218838)" :
    percent > 20 ? "linear-gradient(90deg,#ffc107,#ffb007)" :
    "linear-gradient(90deg,#dc3545,#b02a37)";
}

function updateScore() { scoreCounter.innerText = "Score: " + score; }

function spawnAd() {
  adsSpawned++;
  const adDiv = document.createElement("div");
  adDiv.classList.add("ad");

  const closeBtn = document.createElement("div");
  closeBtn.classList.add("close-btn");
  closeBtn.textContent = "âœ–";
  closeBtn.onclick = (e) => { e.stopPropagation(); adDiv.remove(); };
  adDiv.appendChild(closeBtn);

  const adImage = new Image();
  adImage.src = adImages[Math.floor(Math.random()*adImages.length)];
  adDiv.appendChild(adImage);
  document.body.appendChild(adDiv);
  makeDraggable(adDiv, true);

  const buttonRect = addTimeButton.getBoundingClientRect();
  let spawnX, spawnY;

  let spawnNearCursor = Math.random() < 0.1;
  let spawnNearButton = !spawnNearCursor && Math.random() < 0.5;

  if (spawnNearCursor) {
    spawnX = mouseX - 80 + (Math.random()*50-25);
    spawnY = mouseY - 80 + (Math.random()*50-25);
  } else if (spawnNearButton && buttonRect.width && buttonRect.height) {
    spawnX = buttonRect.left + (Math.random()*buttonRect.width-80);
    spawnY = buttonRect.top + (Math.random()*buttonRect.height-80);
  } else {
    spawnX = Math.random()*(window.innerWidth-160);
    spawnY = Math.random()*(window.innerHeight-160);
  }

  adDiv.style.top = spawnY+"px";
  adDiv.style.left = spawnX+"px";

  if (adsSpawned % 20 === 0) {
    adInterval = Math.max(adInterval-100, 400);
    clearInterval(spawnInterval);
    spawnInterval = setInterval(spawnAd, adInterval);
  }
}

function makeDraggable(element, mobile=false) {
  let pos1=0, pos2=0, pos3=0, pos4=0;
  let isDragging = false;
  const dragThreshold = 5;

  function getClientPos(e) {
    if (e.touches) return { x: e.touches[0].clientX, y: e.touches[0].clientY };
    return { x: e.clientX, y: e.clientY };
  }

  function dragStart(e) {
    const pos = getClientPos(e);
    pos3 = pos.x; pos4 = pos.y;
    isDragging = false;

    if (e.type === 'touchstart') {
      document.addEventListener('touchmove', dragElement, { passive: false });
      document.addEventListener('touchend', closeDrag);
    } else {
      document.onmousemove = dragElement;
      document.onmouseup = closeDrag;
    }

    e.preventDefault();
  }

  function dragElement(e) {
    e.preventDefault();
    const pos = getClientPos(e);
    const deltaX = Math.abs(pos.x - pos3);
    const deltaY = Math.abs(pos.y - pos4);
    if (!isDragging && (deltaX > dragThreshold || deltaY > dragThreshold)) isDragging = true;

    pos1 = pos3 - pos.x;
    pos2 = pos4 - pos.y;
    pos3 = pos.x; pos4 = pos.y;

    if (isDragging) {
      element.style.top = (element.offsetTop - pos2) + "px";
      element.style.left = (element.offsetLeft - pos1) + "px";
    }
  }

  function closeDrag(e) {
    if (e.type.startsWith('touch')) {
      document.removeEventListener('touchmove', dragElement, { passive: false });
      document.removeEventListener('touchend', closeDrag);
    } else {
      document.onmouseup = null;
      document.onmousemove = null;
    }

    if (!isDragging && !e.target.classList.contains("close-btn")) {
      window.open(adLink, "_blank");
    } else if (isDragging) {
      if (
        element.offsetLeft < 20 ||
        element.offsetTop < 20 ||
        element.offsetLeft + element.offsetWidth > window.innerWidth - 20 ||
        element.offsetTop + element.offsetHeight > window.innerHeight - 20
      ) element.remove();
    }
  }

  element.addEventListener('mousedown', dragStart);
  if (mobile) element.addEventListener('touchstart', dragStart, { passive: false });
  element.ondragstart = e => e.preventDefault();
}

function endGame() {
  clearInterval(gameInterval);
  clearInterval(spawnInterval);
  clearInterval(scoreInterval);
  gameRunning=false;
  finalScore.innerText = "Final Score: " + score;
  if (score > highScore) {
    highScore = score;
    localStorage.setItem("highScore", highScore);
  }
  highScoreDisplay.innerText = "High Score: " + highScore;
  gameOverScreen.classList.add("show");
}

restartButton.onclick = () => {
  document.querySelectorAll(".ad").forEach(ad=>ad.remove());
  adsSpawned=0; adInterval=1200; timer=10; score=0;
  gameOverScreen.classList.remove("show");
  startButton.style.display="block";
  instructions.style.display="block";
  titleScreen.style.display="block";
  newUpdateBanner.style.display="block";
  addTimeButton.style.display="none";
  timerContainer.style.display="none";
  updateScore(); updateTimerBar();
};
</script>
</body>
</html>
